\section{Boltzmann Equation}
\todo{Add a chapter intro}

The Boltzmann equation for neutron transport is shown below:

\begin{dmath}\label{e:boltzmann}
{\frac{1}{v} \frac{\partial \psi}{\partial t} + \bm \Omega \cdot \bm \nabla \psi + \Sigma_t\left(\bm x,E,t\right)\psi\left(\bm x,E,\bm \Omega,t\right)} = {\frac{1}{4\pi}\intop_0^{\infty} \intop_{4\pi} \Sigma_s\left(\bm x,E' \rightarrow E, \bm \Omega' \rightarrow \bm \Omega\right) \psi\left(\bm x,E',\bm \Omega'\right) d\Omega' dE'} + {\frac{\chi\left(E\right)}{4\pi} \intop_0^{\infty} \intop_{4\pi} \nu \Sigma_f\left(\bm x,E',t\right) \psi\left(\bm x,E',\bm \Omega,t\right) d\Omega dE' + Q\left(\bm x,E,\bm \Omega,t\right)}
\end{dmath}
\todo{Distinguish between prompt and delayed fission}
\todo{Discuss terms of time-dependent equation, then show steady-state equation}

For many problems, the time dependence of the Boltzmann equation can be neglected.  Doing do eliminates the first term of the equation above.  To ensure neutron balance, this equation is reformulated as an eigenvalue problem.  The eigenvalue $\lambda = \frac{1}{k}$ allows the two sides of the equation to balance.  The cross-sections can then be adjusted until $\lambda = 1$ is achieved, providing a physically meaningful steady-state solution to the equation.  The eigenvalue form of the Boltzmann equation is shown below:

\begin{dmath}\label{e:ssboltzmann}
{\bm \Omega \cdot \bm \nabla \psi + \Sigma_t\left(\bm x,E\right)\psi\left(\bm x,E,\bm \Omega\right) = \frac{1}{4\pi}\intop_0^{\infty} \intop_{4\pi} \Sigma_s\left(\bm x,E' \rightarrow E, \bm \Omega' \rightarrow \bm \Omega\right) \psi\left(\bm x,E',\bm \Omega'\right) d\Omega' dE'} + {\frac{\chi\left(E\right)}{4\pi} \intop_0^{\infty} \intop_{4\pi} \nu \Sigma_f\left(\bm x,E'\right) \psi\left(\bm x,E',\bm \Omega'\right) d\Omega' dE' + \frac{Q\left(\bm x,E,\bm \Omega\right)}{4\pi}}
\end{dmath}
\todo{Use $k_{eff}$ instead of $k$}

Before addressing the methods used to solve equation \ref{e:ssboltzmann}, we will briefly define each of the terms in the equation.  The first term (equation \ref{e:BTEtermsStreaming} is the streaming term.  This describes neutrons with energy $E$ traveling out of the volume dV in the direction $\bm\Omega$.

\begin{equation}\label{e:BTEtermsStreaming}
\bm \Omega \cdot \bm \nabla \psi
\end{equation}

The second term is the total reaction rate (equation \ref{e:BTEtermsTotalRR}).  This describes the total number of collisions experienced in dV by neutrons with energy $E$ and direction $\bm\Omega$.  Equations \ref{e:BTEtermsStreaming} and \ref{e:BTEtermsTotalRR} together make up the total loss of neutrons.

\begin{equation}\label{e:BTEtermsTotalRR}
\Sigma_t\left(\bm x,E\right)\psi\left(\bm x,E\bm\Omega\right)
\end{equation}

Equation \ref{e:BTEtermsScatteringSource} shows the scattering source written in a simplified form.  This is the total number of neutrons scattering into energy $E$ and direction $\bm\Omega$ from all other energies and directions $E'$ and $\bm\Omega'$ in dV.  Because scattering is symmetric around the incident angle, the scattering cross-section depends only on the dot product $\bm\Omega'\cdot\bm\Omega$ rather than each of the two angles independently.

\begin{equation}\label{e:BTEtermsScatteringSource}
\intop_0^{\infty} \intop_{4\pi} \Sigma_s\left(\bm x,E' \rightarrow E, \bm \Omega' \cdot \bm \Omega\right) \psi\left(\bm x,E',\bm \Omega'\right) d\Omega' dE'
\end{equation}

Equation \ref{e:BTEtermsFissionSource} shows neutrons entering dV with energy and direction $E$ and $\bm\Omega$ due to fission.  Fission is an isotropic process, so the total fission source is calculated then distributed evenly across $4\pi$.  Furthermore, the energy distribution of fission is practically independent of incident neutron energy, so the fission neutron distribution $\chi\left(E\right)$ can be outside the integral over energy.

\begin{equation}\label{e:BTEtermsFissionSource}
\frac{\chi\left(E\right)}{4\pi} \intop_0^{\infty} \intop_{4\pi} \nu \Sigma_f\left(\bm x,E,t\right) \psi\left(\bm x,E,\bm \Omega,t\right) d\Omega dE
\end{equation}

Equation \ref{e:BTEtermsExtSource} shows external source term.  This term accounts for all neutrons entering dV with energy and direction $E$ and $\bm\Omega$ from sources other than scatter and fission.  Equation \ref{e:BTEtermsExtSource} shows the source term as a function of angle, but it is often considered to be isotropic like the fission source.

\begin{equation}\label{e:BTEtermsExtSource}
Q\left(\bm x,E,\bm\Omega\right)
\end{equation}

\subsection{Multi-group Approximation}

One important approximation that is commonly made to the transport equation is the multi-group approximation.  To make this approximation, an appropriate energy range for the problem of interest is selected.  This energy range is divided up into $N$ energy groups, with each group going from $E_g$ up to $E_{g-1}$.  For light-water reactor problems, it is common to select 0 eV for $E_N$ and 20 MeV for $E_0$.

We first define the multi-group flux, cross-sections, and chi distribution in equations \ref{e:multigroupDefinitions}.  These definitions ensure that the total reaction rates are preserved in each energy interval $g$.

\begin{subequations}\label{e:multigroupDefinitions}
\begin{equation}\label{e:multigroupangflux}
\psi_g\left(\bm x,\bm \Omega\right)=\frac{1}{E_{n-1}-E_n} \intop_{E_n}^{E_{n-1}} \psi\left(\bm x,E,\bm\Omega\right) dE
\end{equation}
\begin{equation}\label{e:multigroupXS}
\Sigma_{x,g} \psi_g = \frac{1}{E_{n-1}-E_n} \intop_{E_n}^{E_{n-1}} \psi\left(E\right) \Sigma_x\left(E\right) dE \Rightarrow \Sigma_x,g = \frac{\intop_{E_n}^{E_{n-1}} \psi\left(E\right) \Sigma_x\left(E\right) dE}{\intop_{E_n}^{E_{n-1}} \psi\left(E\right) dE}
\end{equation}
\end{subequations}

Using the definitions above, equation \ref{e:ssboltzmann} can be operated on by \ref{e:multigroupIntegral} to obtain the multi-group transport equation \ref{e:multigroupboltzmann}

\begin{equation}\label{e:multigroupIntegral}
\frac{1}{E_{n-1} - E_n}\intop_{E_n}^{E_{n-1}}\left(\cdot\right)dE.
\end{equation}

\begin{dmath}\label{e:multigroupboltzmann}
{\bm \Omega \cdot \bm \nabla \psi_g + \Sigma_{t,g}\left(\bm x\right)\psi_g\left(\bm x,\bm \Omega\right) = \frac{1}{4\pi}\sum_{g'=1}^G \intop_{4\pi} \Sigma_{s,g'\rightarrow g}\left(\bm x,\bm \Omega' \rightarrow \bm \Omega\right) \psi_{g'}\left(\bm x,\bm \Omega'\right) d\Omega'} + {\frac{1}{k}\frac{\chi_g}{4\pi} \sum_{g'=1}^{G} \nu \Sigma_{f,g'}\left(\bm x\right) \intop_{4\pi} \psi_{g'}\left(\bm x,\bm \Omega'\right)d\Omega' + \frac{Q_g\left(\bm x,E\right)}{4\pi}}.
\end{dmath}

\subsection{Discrete Ordinates Approximation}

In addition to energy discretization, it is also useful to discretize the transport equation in angle.  To do this, we use an angular quadrature with angles $\bm\Omega_n$ and associated weights $w_n$:
\todo{More carefully show discretization of polar/azimuthal angles}

\begin{subequations}
\begin{equation}
\sum_{n=1}^N w_n = 4\pi
\end{equation}
\begin{equation}
\sum_{n=1}^N \bm\Omega_n w_n = 0
\end{equation}
\begin{equation}
\intop_{4\pi} f\left(\Omega\right)d\Omega \approx \sum_{n=1}^N f_n w_n
\end{equation}
\end{subequations}

Applying this discretization to the multi-group transport equation \ref{e:multigroupboltzmann}, we obtain the following discrete ordinates (S$_N$) equations:

\begin{dmath}
\bm\Omega_n\cdot\bm\nabla\psi_{g,n} + \Sigma_{t,g}\left(\bm x\right)\psi_{g,n}\left(\bm x\right) = {\frac{1}{4\pi}\sum_{g'=1}^G \sum_{n'=1}^N \Sigma_{g'\rightarrow g,n'\rightarrow n}\left(\bm x\right)\psi_{g',n'}\left(\bm x\right)} + {\frac{1}{k}\frac{\chi_g}{4\pi} \sum_{g'=1}^G \nu\Sigma_{f,g'}\left(\bm x\right)\sum_{n'=1}^N \psi_{g,n}\left(\bm x\right)} + \frac{Q_{g,n}\left(\bm x\right)}{4\pi}
\end{dmath}

\subsection{Diffusion Approximation}

Another approximation that can be made to the angular dependence of the transport equation is the diffusion approximation.  To derive this approximation, we again being with the multi-group transport equation from equation \ref{e:multigroupboltzmann}.  First, we obtain the P$_1$ form of the equation by operating on it by $\intop\left(\cdot\right)d\Omega$ and $\intop\left(\cdot\right)\Omega_i d\Omega$.  To simplify these integrals, we make use of the following identities for integrating over $\bm\Omega$:

\begin{subequations}\label{e:omegaIdentities}
\begin{equation}
\intop_{4\pi} d\Omega = 4\pi
\end{equation}
\begin{equation}
\intop_{4\pi} \Omega_i d\Omega = 0
\end{equation}
\begin{equation}
\intop_{4\pi} \Omega_i\Omega_j d\Omega = \frac{4\pi}{3}\delta_{i,j}
\end{equation}
\begin{equation}
\intop_{4\pi} \Omega_i\Omega_j\Omega_k d\Omega = 0
\end{equation}
\end{subequations}

We must also assume that the angular flux is linearly anisotropic.  This leads to the following expression of the angular flux as a function of the scalar flux $\phi$ and current $J$:

\begin{subequations}
\begin{equation}
\psi_g\left(\bm x,\bm\Omega\right) \approx \frac{1}{4\pi}\left(\phi_g\left(\bm x\right) + 3\bm\Omega \cdot \bm J\left(\bm x\right)\right)
\end{equation}
\begin{equation}
\phi_g\left(\bm x\right) = \intop_{4\pi} \psi_g\left(\bm x,\bm\Omega\right) d\Omega
\end{equation}
\begin{equation}
J_g\left(\bm x\right) = \intop_{4\pi} \psi_g\left(\bm x,\bm\Omega\right) \bm\Omega d\Omega
\end{equation}
\end{subequations}

Applying this assumption and integrating, we obtain a coupled set of four equations for the scalar flux and the three components of the current vector.

\begin{subequations}\label{e:P1transport}
\begin{dmath}\label{e:P1transport-0th}
\frac{d J_x}{dx} + \frac{d J_y}{dy} + \frac{d J_z}{dz} + \Sigma_{t,g}\left(\bm x\right)\phi_g\left(\bm x\right) = {\sum_{g'=1}^G \Sigma_{s0,g'\rightarrow g}\left(\bm x\right)\phi_{g'}\left(\bm x\right)} + {\frac{1}{k}\frac{\chi_g}{4\pi}\sum_{g'=1}^G \nu\Sigma_{f,g'}\left(\bm x\right)\phi_{g'}\left(\bm x\right)} + Q_g\left(\bm x\right)
\end{dmath}
\begin{dmath}\label{e:P1transport-1st-x}
\frac{d\phi_g}{dx} + \Sigma_{t,g}\left(\bm x\right)J_{x,g}\left(\bm x\right)  = {\sum_{g'=1}^G \Sigma_{s1,g'\rightarrow g}\left(\bm x\right) J_{x,g'}\left(\bm x\right)}
\end{dmath}
\begin{dmath}\label{e:P1transport-1st-y}
\frac{d\phi_g}{dy} + \Sigma_{t,g}\left(y\right)J_{y,g}\left(\bm x\right)  = {\sum_{g'=1}^G \Sigma_{s1,g'\rightarrow g}\left(\bm x\right) J_{y,g'}\left(\bm x\right)}
\end{dmath}
\begin{dmath}\label{e:P1transport-1st-z}
\frac{d\phi_g}{dz} + \Sigma_{t,g}\left(\bm x\right)J_{z,g}\left(\bm x\right)  = {\sum_{g'=1}^G \Sigma_{s1,g'\rightarrow g}\left(\bm x\right) J_{z,g'}\left(\bm x\right)}
\end{dmath}
\end{subequations}

Solving equations \ref{e:P1transport-1st-x}-\ref{e:P1transport-1st-z} for the components of the current, we obtain the following expression:

\begin{subequations}\label{e:FicksLaw}
\begin{equation}\label{e:FicksLawCurrent}
\bm J_g\left(\bm x\right) = -D_g\left(\bm x\right) \bm\nabla \phi_g\left(\bm x\right)
\end{equation}
\begin{equation}\label{e:FicksLawDiffConstant}
D_g\left(\bm x\right) = \frac{1}{3}\left(\Sigma_{t,g}-\sum_{g'=1}^G \Sigma_{s1,g'\rightarrow g}\left(\bm x\right)\right)^{-1}
\end{equation}
\end{subequations}

Substituting \ref{e:FicksLawCurrent} into \ref{e:P1transport-0th} gives us the diffusion form of the transport equation, which has only the scalar flux $\phi$ and eigenvalue $\frac{1}{k}$ as unknowns.

\begin{dmath}\label{e:DiffusionEquation}
-\bm\nabla \cdot D_g\left(\bm x\right) \bm \nabla\phi_g\left(\bm x\right) + \Sigma_{t,g}\left(\bm x\right)\phi_g\left(\bm x\right) = {\sum_{g'=1}^G \Sigma_{s0,g'\rightarrow g}\left(\bm x\right)\phi_{g'}\left(\bm x\right)} + {\frac{1}{k}\frac{\chi_g}{4\pi} \sum_{g'=1}^G \nu\Sigma_{f,g'}\left(\bm x\right)\phi_{g'}\left(\bm x\right)} + Q_g\left(\bm x\right)
\end{dmath}

\subsection{Scattering Approximations}

One of the biggest challenges to solving the transport equation is angle dependence of the scattering cross-sections and angular flux.  To simplify the scattering cross-sections, there are two different types of approximations that can be made in MPACT.

\subsubsection{P$_N$ Scattering}

The first scattering approximation that can be made is P$_N$ scattering.  To make this approximation, the $\bm\Omega'\cdot\bm\Omega$ is rewritten as a single angular variable $\mu$, the cosine between the incoming and outgoing scattering angles.  The scattering cross-section can then be expanded in terms of Legendre polynomials, defined by equations \ref{e:LegendrePolynomials}.
\todo{do $\mu_s$ instead of $\mu$}

\begin{subequations}\label{e:LegendrePolynomials}
\begin{equation}
P_{n+1}\left(\bm x\right) = \frac{\left(2n+1\right)xP_n\left(\bm x\right) - nP_{n-1}\left(\bm x\right)}{n+1}
\end{equation}
\begin{equation}
P_0\left(\bm x\right) = 1
\end{equation}
\begin{equation}
P_1\left(\bm x\right) = x
\end{equation}
\begin{equation}
\intop_{-1}^1 P_n\left(\bm x\right) P_m\left(\bm x\right) dx = \frac{2}{2n+1}\delta_{n,m}
\end{equation}
\end{subequations}

Equations \ref{e:PnScatteringExpansion} show the expansion of the scattering cross-section using Legendre polynomials.  Using more terms in the expansion improves the accuracy.  For most reactor problems, $N \le 3$ is sufficient.  Problems such as shielding and others may require many more terms to be kept to obtain sufficient accuracy.

\begin{subequations}\label{e:PnScatteringExpansion}
\begin{equation}
\Sigma_s\left(\bm x,\mu\right) = \sum_{n=0}^N \frac{2n+1}{4\pi} P_n\left(\mu\right) \Sigma_{sn}\left(\bm x\right)
\end{equation}
\begin{equation}
\Sigma_{s,n}\left(\bm x\right) = \intop_{-1}^1 \Sigma_s\left(\bm x,\mu\right) P_n\left(\mu\right) d\mu
\end{equation}
\end{subequations} 

\subsection{Transport Correction}

A second simplification of the scattering source that can be used is transport-corrected isotropic (TCP$_0$) scattering.  When using this approximation, the equation is solved using only the zeroth order term in \ref{e:PnScatteringExpansion}.  The cross-section data used to develop the multi-group scattering cross-sections is modified beforehand to still preserve some of the higher order scattering physics.

Equations \ref{e:outscatterTCP0} show the out-scatter transport correction, which is commonly used in MPACT.  In this correction, the total cross-section and zeroth moment of the self-scatter cross-section are modified by subtracting the sum of the first-order out-scatter data.  There are several variants of the out-scatter correction as well as other completely different correction techniques \todo{Cite for out-scatter, in-scatter, NLC, etc.} that are available in MPACT but will not be discussed in detail here.

\begin{subequations}\label{e:outscatterTCP0}
\begin{equation}
\Sigma_{tr,g} = \Sigma_{t,g} - \sum_{g'=1}^G \Sigma_{s1,g\rightarrow g'}
\end{equation}
\begin{equation}
\Sigma_{s0,g\rightarrow g} = \Sigma_{s0,g\rightarrow g} - \sum_{g'=1}^G \Sigma_{s1,g\rightarrow g'}
\end{equation}
\end{subequations}

\section{Numerical Methods}

A wide variety of numerical methods exist to solve the transport equation, but all of them can be categorized in one of two ways: stochastic (Monte Carlo) or deterministic methods.  Monte Carlo methods use random numbers to directly sample probability distribution functions based on the material cross-sections.  These methods can produce highly accurate, detailed results and make no assumptions about the materials or geometry of the problem.  However, because of the random nature of the method, there is always some uncertainty in the answer.  For large problems, the number of particles that must be simulated to achieve acceptable levels of uncertainty is often too burdensome \ifdraft{\todo{Need a better word}}{} for practical calculations.

All the work discussed in the following sections makes use of deterministic methods.  There are many different deterministic methods, but only the ones relevant to this work will be discussed in the coming sections.

\ifdraft{\subsection{Method of Characteristics}

One method that is commonly used to solve the transport equation is the Method of Characteristics (MOC).  This method allows the transport equation to be solved along a characteristic direction without any approximations, making it useful for complicated geometries, such as those found in nuclear reactors.  To derive this method, the right-hand side of equation \ref{e:ssboltzmann} is replaced by the variable $q$:

\begin{subequations}
\begin{equation}
\bm \Omega \cdot \bm \nabla \psi + \Sigma_t\left(\bm x,E\right)\psi\left(\bm x,E,\bm \Omega\right) = q\left(\bm x,E.\bm \Omega\right)
\end{equation}
\begin{dmath}\label{e:MOCqboltzmann}
{q\left(\bm x,E,\bm \Omega\right) = \intop_{4\pi} \Sigma_s\left(\bm x,E' \rightarrow E, \bm \Omega' \rightarrow \bm \Omega\right) \psi\left(\bm x,E',\bm \Omega'\right) d\bm \Omega'} + {\frac{1}{k}\frac{\chi\left(E\right)}{4\pi} \intop \nu \Sigma_f\left(\bm x,E\right) \psi\left(\bm x,E,\bm \Omega\right) dE + Q\left(\bm x,E,\bm \Omega\right)}
\end{dmath}
\end{subequations}

Now the characteristic direction is introduced:

\begin{equation}
\bm r = \bm {r_0} + s \bm \Omega \Rightarrow \begin{cases} x\left(s\right) = x_0 + s\Omega_x \\ y\left(s\right) = y_0 + s\Omega_y \\ z\left(s\right) = z_0 + s\Omega_z\end{cases}
\end{equation}

Substituting this variable into equation \ref{e:MOCqboltzmann} gives the characteristic form of this equation:

\begin{subequations}
\begin{equation}
\frac{\partial \psi}{\partial s} + \Sigma_t\left(\bm r0_0 + s\bm\Omega,E\right)\psi\left(\bm r0_0 + s\bm\Omega,E,\bm \Omega\right) = q\left(\bm r0_0 + s\bm\Omega,E.\bm \Omega\right)
\end{equation}
\begin{dmath}\label{e:characteristicboltzmann}
{q\left(\bm r0_0 + s\bm\Omega,E,\bm \Omega\right) = \intop_{4\pi} \Sigma_s\left(\bm {r_0} + s \bm\Omega',E' \rightarrow E, \bm \Omega' \rightarrow \bm \Omega\right) \psi\left(\bm {r_0} + s\bm\Omega',E',\bm \Omega'\right) d\bm \Omega'} + {\frac{1}{k}\frac{\chi\left(E\right)}{4\pi} \intop \nu \Sigma_f\left(\bm r0_0 + s\bm\Omega,E\right) \psi\left(\bm {r_0} + s\bm\Omega,E,\bm \Omega\right) dE + Q\left(\bm {r_0} + s\bm\Omega,E,\bm \Omega\right)}
\end{dmath}
\end{subequations}

This equation is easily solved using an integrating factor

\begin{equation}
\exp{-\intop_0^s \Sigma_t\left(\bm {r_0} + s'\bm\Omega,E\right)ds'}
\end{equation}

giving the following solution:

\begin{dmath}\label{e:MOCexact}
{\psi\left(\bm {r_0} + s\bm\Omega,\bm\Omega,E\right) = \psi\left(\bm {r_0},\bm\Omega,E\right)\exp{\left(-\intop_0^s \Sigma_t\left(\bm {r_0} + s'\bm\Omega,E\right)ds'\right)}} + {\intop_0^s q\left(\bm {r_0} + s'\bm\Omega,\bm\Omega, E\right)\exp{\left(-\intop_0^s \Sigma_t\left(\bm {r_0} + s''\bm\Omega,E\right)ds''\right)}ds'}
\end{dmath}

Now if $\bm {r_0}$ is on the boundary of the region of interest, the incoming flux $\psi\left(\bm {r_0},\bm \Omega, E\right)$ is known.  This allows the angular flux to be calculated at any point $s$ to be calculated along the characteristic direction $\bm r$.

Up to this point, no approximations have been made in deriving the method of characteristics.  One approximation that is necessary to use MOC for practical problems is to assume some spatial shape for the source term $q$.  The simplest of these is the flat source approximation.  In this approximation, $q$ is assumed to be flat along $\bm r$.  This simplifies equation \ref{e:MOCexact} to the following:

\begin{dmath}\label{e:MOCflatsource}
\psi\left(\bm {r_0} + s\bm\Omega,\bm\Omega,E\right) = \psi\left(\bm {r_0},\bm\Omega,E\right)\exp{\left(-\intop_0^s \Sigma_t\left(\bm {r_0} + s'\bm\Omega,E\right)ds'\right)} + \cdots
\end{dmath}
% Things to talk about:
%   Flat/linear sources

\subsection{Source Iteration}

Using MOC, fixed source transport problems can be solved.  However, in realistic calculations it is rare that the scattering or fission sources are known.  In order to solve the transport equation for problems with an unknown source distribution, the equation can be re-formulated as follows:
\hl{Insert source iteration form of the equation}

Now making some initial guess for \hl{$\phi^-1$} allows us to solve for \hl{$\phi^0$}.  This process can be repeated for all \hl{$\phi^n$} using the previous iterate \hl{variable$\phi^{n-1}$}.  This method is known as Source Iteration (SI).

Source iteration also has a convenient physical interpretation.  Selecting zero as the initial guess means that the first iterate \hl{$\phi^0$} is simply equal to the sum of sources of new neutrons.  Plugging the expression for \hl{$\phi^0$} into the equation for \hl{$\phi^1$}, we find that the \hl{$\phi^1$} is 

\hl{make sure to talk about how ridiculously slowly it can converge.  Find some references for the math if possible}}{}

\subsection{Coarse-Mesh Finite Difference}\label{ss:CMFD}

The source iteration method provides a convenient way of solving transport problems that guarantees a positive, correct solution.  However, because the source iteration can take hundreds of iterations to converge for typical reactor problems, it is important to accelerate the convergence.  The most common way of doing this is the Coarse-Mesh Finite Difference (CMFD) method.  This method involves solving a diffusion problem on a coarse grid to get the average magnitude of the flux in each coarse cell.  This is then used to scale the flux solution on the fine mesh cells.  In order to ensure consistency between the transport solution and the lower order diffusion solution, coupling coefficients are calculated on the boundaries of the coarse mesh cells to correct the leakage between the cells.

\ifdraft{To derive this method, we begin with equation \hl{diffusion equation} and apply the multigroup approximation:
\hl{multi-group diffusion equation}

\begin{equation}
\end{equation}

Integrating this equation over some volume $V$ and dividing by the total volume creates and equation for the average scalar flux $\overline{\phi}$ in that cell.
\hl{discretized equation}

\begin{equation}
\end{equation}

The boundary conditions for each cell are the currents at the interface between two cells:
\hl{boundary condition equation}

\begin{equation}
\end{equation}

This equation can be determined for each cell in the problem to set up a linear system.  This system can then be solved using one of a variety of standard linear solvers.

Because the currents in the matrix are calculated from the diffusion equation, an inconsistency between the diffusion and transport solutions will arise.  To account for this, current correction factors are calculated at the cell boundaries using the fine mesh transport calculations.  These correction factors are calculated as follows:
\hl{dhat equation}

\begin{equation}
\end{equation}

This defines a relationship between the scalar fluxes on each sides of the interface and the current at the interface.  This relationship allows us to correct the diffusion current that is used in the CMFD matrix:\hl{corrected diffusion current}

\begin{equation}
\end{equation}

\subsection{Simplified Pn}

\hl{I can actually probably get rid of this section completely by just referring to the axial solver as $P_3$ instead of $SP_3$}

\subsection{Power Iteration}



\subsection{Collision Probabilities Method}}{}